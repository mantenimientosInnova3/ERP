<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Reporte de gastos por centro de costo</title>
    <style>
        body { font-family: DejaVu Sans, sans-serif; font-size: 10pt; }

        .header { width: 100%; margin-bottom: 10px; }
        .logo { float: left; }
        .company { float: right; text-align: right; font-size: 9pt; }
        .clear { clear: both; }

        h1 { text-align: center; color: #003366; margin: 10px 0 5px 0; }
        h2 { color: #003366; margin: 15px 0 5px 0; font-size: 12pt; }

        table { width: 100%; border-collapse: collapse; margin-top: 5px; }
        th, td { border: 1px solid #ccc; padding: 4px; }
        th { background-color: #f0f0f0; }

        tr:nth-child(even) td { background-color: #fafafa; }

        .subtotal { text-align: right; font-weight: bold; margin-top: 5px; color: #333; }
        .cc-block { margin-bottom: 18px; }

        .total-general {
            margin-top: 20px;
            font-size: 11pt;
            font-weight: bold;
            color: #002244;
            text-align: right;
        }

        .filters {
            font-size: 9pt;
            margin-top: 5px;
            margin-bottom: 10px;
            color: #555;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="header">
    <div class="logo">
        <!-- Ajusta la ruta al logo si es necesario -->
        <img src="{{ logo_url }}" alt="Logo Innova" width="80">
    </div>
    <div class="company">
        <strong>Innova Pavimentos de MÃ©xico</strong><br>
        Reporte de gastos por centro de costo<br>
        Generado: {{ now|date:"d/m/Y H:i" }}
    </div>
    <div class="clear"></div>
</div>

<h1>Reporte de gastos por centro de costo</h1>

<div class="filters">
    {% if request.GET.fecha_inicio %}Desde: {{ request.GET.fecha_inicio }}{% endif %}
    {% if request.GET.fecha_fin %} &nbsp; | &nbsp; Hasta: {{ request.GET.fecha_fin }}{% endif %}
    {% if request.GET.centro_costo %}
        &nbsp; | &nbsp; Centro de costo filtrado: {{ request.GET.centro_costo }}
    {% endif %}
    {% if not request.GET.fecha_inicio and not request.GET.fecha_fin and not request.GET.centro_costo %}
        Sin filtros aplicados
    {% endif %}
</div>

{% for cc in cc_data %}
<div class="cc-block">
    <h2>Centro de costo: {{ cc.centro_costo }}</h2>

    {% if cc.detalles %}
        <table>
            <tr>
                <th>Producto</th>
                <th>Cantidad</th>
                <th>Precio</th>
                <th>Gasto</th>
            </tr>
            {% for det in cc.detalles %}
            <tr>
                <td>{{ det.producto }}</td>
                <td>{{ det.cantidad }}</td>
                <td>${{ det.precio }}</td>
                <td>${{ det.gasto|floatformat:2 }}</td>
            </tr>
            {% endfor %}
        </table>
        <p class="subtotal">
            Total gastado en {{ cc.centro_costo }}: ${{ cc.total_gasto|floatformat:2 }}
        </p>
    {% else %}
        <p>No hay productos para este centro de costo.</p>
    {% endif %}
</div>
{% endfor %}

<p class="total-general">
    Total general: ${{ total_general|floatformat:2 }}
</p>

</body>
</html>
